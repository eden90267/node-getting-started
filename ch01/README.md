# 基礎知識

## Node 是什麼

Node 是一個 JavaScript 運行 runtime

runtime 運行環境包括：

- 運行代碼需要的編譯器
- 操作系統的底層支持
- ...

Node 底層使用 C++ 實現，語法則遵循 ECMAScript 規範

程式語言？

程式語言是一種抽象的規範，拿 C++ 來說，真正的 C++
其實是厚厚的一疊文檔，上面規定了每一個語法細節以及每一個有效輸入對應的輸出值。而開發者平時使用的
C++，例如 Visual C++，是 C++
的一種實現。就好像數學概念裡的正方形一樣，我們找不到一個抽象的，純粹的“正方形”，我們平時看到的都是正方形的物體

為什麼是 JavaScript

Ryan Dahl 選擇了 JavaScript 和
V8，前者提供了靈活的語法，後者為前者的運行提供了足夠高的效率和實現，例如非阻塞 IO 和事件驅動等。

### runtime 和 VM

#### 1. runtime

最出名的 runtime 應該是 VC++，這套應用程序組件可以使開發者編寫的 C/C++
語言程序在其中運行。VC++ 本身對 C++ 還做了一些擴展，用來開發 Windows 程序，例如
MFC 等

VC++ 可以編譯和執行用戶編寫的 C/C++
代碼，而開發者不考慮這背後到底是怎樣實現的。一個 X 語言 runtime
表示開發者可以在這個 runtime 上運行 X 語言編寫的代碼。

Chrome 也是一個 JavaScript 運行時，它靠背後的 JavaScript 引擎來運行
JavaScript 代碼

runtime 可能會對程式語言做一些擴展，例如 Node 中的 fs 模組和 Buffer 類型就是對
ECMAScript 的擴展，此外，runtime 也不一定支持語言規範定義的全部特性

如果沒有 runtime 支持，語言規範就和廢紙無異 (import
語句)；反過來講，就算一個特性沒有體現在標準裡，而大多數的運行時都支持它，也可以變成事實上的規範
(`__proto__` 屬性)

因此我們談論一個語言，往往是談論它的實現，再具體一點，就是指其運行時實現

#### 2. VM

VM 的概念比較廣泛，通常可以認為是在硬件和二進制文件的中間層

C++ 編譯好的二進制文件可以直接被操作系統調用，而對 Java
而言，編譯好的字節碼是交給虛擬機來運行的，這樣的好處是對開發者屏蔽了操作系統之間的差異，對於不同操作系統環境的具體處理交給虛擬機來完成，從這個角度來看，VM
是對不同計算機系統的一種抽象

## Node 的內部機制